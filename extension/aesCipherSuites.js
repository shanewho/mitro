(function(){function m(h){function k(a,b,c){b=b.entity===h.tls.ConnectionEnd.client;a.read.cipherState={init:!1,cipher:h.aes.createDecryptionCipher(b?c.keys.server_write_key:c.keys.client_write_key),iv:b?c.keys.server_write_IV:c.keys.client_write_IV};a.write.cipherState={init:!1,cipher:h.aes.createEncryptionCipher(b?c.keys.client_write_key:c.keys.server_write_key),iv:b?c.keys.client_write_IV:c.keys.server_write_IV};a.read.cipherFunction=q;a.write.cipherFunction=d;a.read.macLength=a.write.macLength=
c.mac_length;a.read.macFunction=a.write.macFunction=f.hmac_sha1}function d(a,b){var c=!1,e=b.macFunction(b.macKey,b.sequenceNumber,a);a.fragment.putBytes(e);b.updateSequenceNumber();e=1<a.version.minor?h.random.getBytes(16):b.cipherState.init?null:b.cipherState.iv;b.cipherState.init=!0;var g=b.cipherState.cipher;g.start(e);1<a.version.minor&&g.output.putBytes(e);g.update(a.fragment);g.finish(r)&&(a.fragment=g.output,a.length=a.fragment.length(),c=!0);return c}function r(a,b,c){c||(a-=b.length()%a,
b.fillWithByte(a-1,a));return!0}function l(a,b,c){a=!0;if(c){c=b.length();for(var e=b.last(),g=c-1-e;g<c-1;++g)a=a&&b.at(g)==e;a&&b.truncate(e+1)}return a}function q(a,b){var c=!1,c=b.cipherState.init?null:b.cipherState.iv;b.cipherState.init=!0;var e=b.cipherState.cipher;e.start(c);e.update(a.fragment);for(var c=e.finish(l),g=b.macLength,d="",f=0;f<g;++f)d+=String.fromCharCode(0);f=e.output.length();f>=g?(a.fragment=e.output.getBytes(f-g),d=e.output.getBytes(g)):a.fragment=e.output.getBytes();a.fragment=
h.util.createBuffer(a.fragment);a.length=a.fragment.length();e=b.macFunction(b.macKey,b.sequenceNumber,a);b.updateSequenceNumber();return e===d&&c}var f=h.tls;f.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=f.BulkCipherAlgorithm.aes;a.cipher_type=f.CipherType.block;a.enc_key_length=16;a.block_length=16;a.fixed_iv_length=16;a.record_iv_length=16;a.mac_algorithm=f.MACAlgorithm.hmac_sha1;a.mac_length=
20;a.mac_key_length=20},initConnectionState:k};f.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=f.BulkCipherAlgorithm.aes;a.cipher_type=f.CipherType.block;a.enc_key_length=32;a.block_length=16;a.fixed_iv_length=16;a.record_iv_length=16;a.mac_algorithm=f.MACAlgorithm.hmac_sha1;a.mac_length=20;a.mac_key_length=20},initConnectionState:k}}if("function"!==typeof define)if("object"===typeof module&&module.exports){var s=
!0;define=function(h,k){k(require,module)}}else return"undefined"===typeof forge&&(forge={}),m(forge);var n,t=function(h,k){k.exports=function(d){var k=n.map(function(d){return h(d)}).concat(m);d=d||{};d.defined=d.defined||{};if(d.defined.aesCipherSuites)return d.aesCipherSuites;d.defined.aesCipherSuites=!0;for(var l=0;l<k.length;++l)k[l](d);return d.aesCipherSuites}},p=define;define=function(h,k){n="string"===typeof h?k.slice(2):h.slice(2);if(s)return delete define,p.apply(null,Array.prototype.slice.call(arguments,
0));define=p;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./aes","./tls"],function(){t.apply(null,Array.prototype.slice.call(arguments,0))})})();
