(function(){function p(e){(e.pss=e.pss||{}).create=function(b,r,l){var g=b.digestLength;return{verify:function(n,k,a){var c;c=a-1;a=Math.ceil(c/8);k=k.substr(-a);if(a<g+l+2)throw{message:"Inconsistent parameters to PSS signature verification."};if(188!==k.charCodeAt(a-1))throw{message:"Encoded message does not end in 0xBC."};var d=a-g-1,m=k.substr(0,d);k=k.substr(d,g);var f=65280>>8*a-c&255;if(0!==(m.charCodeAt(0)&f))throw{message:"Bits beyond keysize not zero as expected."};var q=r.generate(k,d),
h="";for(c=0;c<d;c++)h+=String.fromCharCode(m.charCodeAt(c)^q.charCodeAt(c));h=String.fromCharCode(h.charCodeAt(0)&~f)+h.substr(1);a=a-g-l-2;for(c=0;c<a;c++)if(0!==h.charCodeAt(c))throw{message:"Leftmost octets not zero as expected"};if(1!==h.charCodeAt(a))throw{message:"Inconsistent PSS signature, 0x01 marker not found"};a=h.substr(-l);d=new e.util.ByteBuffer;d.fillWithByte(0,8);d.putBytes(n);d.putBytes(a);b.start();b.update(d.getBytes());n=b.digest().getBytes();return k===n},encode:function(n,k){var a,
c=k-1,d=Math.ceil(c/8),m=n.digest().getBytes();if(d<g+l+2)throw{message:"Message is too long to encrypt"};var f=e.random.getBytes(l);a=new e.util.ByteBuffer;a.fillWithByte(0,8);a.putBytes(m);a.putBytes(f);b.start();b.update(a.getBytes());m=b.digest().getBytes();a=new e.util.ByteBuffer;a.fillWithByte(0,d-l-g-2);a.putByte(1);a.putBytes(f);var q=a.getBytes(),h=d-g-1,p=r.generate(m,h),f="";for(a=0;a<h;a++)f+=String.fromCharCode(q.charCodeAt(a)^p.charCodeAt(a));c=65280>>8*d-c&255;f=String.fromCharCode(f.charCodeAt(0)&
~c)+f.substr(1);return f+m+String.fromCharCode(188)}}}}if("function"!==typeof define)if("object"===typeof module&&module.exports){var u=!0;define=function(e,b){b(require,module)}}else return"undefined"===typeof forge&&(forge={}),p(forge);var s,v=function(e,b){b.exports=function(b){var l=s.map(function(b){return e(b)}).concat(p);b=b||{};b.defined=b.defined||{};if(b.defined.pss)return b.pss;b.defined.pss=!0;for(var g=0;g<l.length;++g)l[g](b);return b.pss}},t=define;define=function(e,b){s="string"===
typeof e?b.slice(2):e.slice(2);if(u)return delete define,t.apply(null,Array.prototype.slice.call(arguments,0));define=t;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./random","./util"],function(){v.apply(null,Array.prototype.slice.call(arguments,0))})})();
