(function(){function n(k){function m(e,c,a){a||(a=k.md.sha1.create());for(var f="",h=Math.ceil(c/a.digestLength),b=0;b<h;++b){var d=String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255);a.start();a.update(e+d);f+=a.digest().getBytes()}return f.substring(0,c)}var g=k.pkcs1=k.pkcs1||{};g.encode_rsa_oaep=function(e,c,a,f,h){var b=void 0,d=void 0,l=void 0,g=void 0;"string"===typeof a?(b=a,d=f||void 0,l=h||void 0):a&&(b=a.label||void 0,d=a.seed||void 0,l=a.md||void 0,a.mgf1&&a.mgf1.md&&(g=a.mgf1.md));
l?l.start():l=k.md.sha1.create();g||(g=l);e=Math.ceil(e.n.bitLength()/8);f=e-2*l.digestLength-2;if(c.length>f)throw{message:"RSAES-OAEP input message length is too long.",length:c.length,maxLength:f};b||(b="");l.update(b,"raw");b=l.digest();a="";f-=c.length;for(h=0;h<f;h++)a+="\x00";c=b.getBytes()+a+"\u0001"+c;if(!d)d=k.random.getBytes(l.digestLength);else if(d.length!==l.digestLength)throw{message:"Invalid RSAES-OAEP seed. The seed length must match the digest length.",seedLength:d.length,digestLength:l.digestLength};
e=m(d,e-l.digestLength-1,g);c=k.util.xorBytes(c,e,c.length);l=m(c,l.digestLength,g);return"\x00"+k.util.xorBytes(d,l,d.length)+c};g.decode_rsa_oaep=function(e,c,a,f){var h=void 0,b=void 0,d=void 0;"string"===typeof a?(h=a,b=f||void 0):a&&(h=a.label||void 0,b=a.md||void 0,a.mgf1&&a.mgf1.md&&(d=a.mgf1.md));a=Math.ceil(e.n.bitLength()/8);if(c.length!==a)throw{message:"RSAES-OAEP encoded message length is invalid.",length:c.length,expectedLength:a};void 0===b?b=k.md.sha1.create():b.start();d||(d=b);if(a<
2*b.digestLength+2)throw{message:"RSAES-OAEP key is too short for the hash function."};h||(h="");b.update(h,"raw");h=b.digest().getBytes();e=c.charAt(0);f=c.substring(1,b.digestLength+1);c=c.substring(1+b.digestLength);var g=m(c,b.digestLength,d);f=k.util.xorBytes(f,g,f.length);d=m(f,a-b.digestLength-1,d);d=k.util.xorBytes(c,d,c.length);c=d.substring(0,b.digestLength);e="\x00"!==e;for(a=0;a<b.digestLength;++a)e|=h.charAt(a)!==c.charAt(a);h=1;for(b=c=b.digestLength;b<d.length;b++)a=d.charCodeAt(b),
f=a&1^1,e|=a&(h?65534:0),h&=f,c+=h;if(e||1!==d.charCodeAt(c))throw{message:"Invalid RSAES-OAEP padding."};return d.substring(c+1)}}if("function"!==typeof define)if("object"===typeof module&&module.exports){var r=!0;define=function(k,m){m(require,module)}}else return"undefined"===typeof forge&&(forge={}),n(forge);var p,s=function(k,m){m.exports=function(g){var e=p.map(function(a){return k(a)}).concat(n);g=g||{};g.defined=g.defined||{};if(g.defined.pkcs1)return g.pkcs1;g.defined.pkcs1=!0;for(var c=
0;c<e.length;++c)e[c](g);return g.pkcs1}},q=define;define=function(k,m){p="string"===typeof k?m.slice(2):k.slice(2);if(r)return delete define,q.apply(null,Array.prototype.slice.call(arguments,0));define=q;return define.apply(null,Array.prototype.slice.call(arguments,0))};define(["require","module","./util","./random","./sha1"],function(){s.apply(null,Array.prototype.slice.call(arguments,0))})})();
