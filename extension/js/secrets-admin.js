(function(){$(document).ready(function(){$("#search-string").keyup(function(){filterSecrets($(this).val())});var n=showSpinny($(".spinny"));mitro.loadOrganizationInfo(function(d){d=d.getSelectedOrganization();background.getOrganization(d.id,function(g){var k=_.values(g.orgSecretsToPath);console.log("fetched "+k.length+" secrets");hideSpinny($(".spinny"),n);0<k.length?$(".has-secrets").removeClass("hide"):$(".has-no-secrets").removeClass("hide");for(var d=0;d<k.length;d++){var a=k[d],e=g;a.renderedTitle=
getRenderedTitle(a);a.host=getCanonicalHost(a.clientData.loginUrl);for(var l=a,c=a,h=e.groups,b=0,f=0;f<c.groups.length;++f)c.groups[f]in h?isVisibleGroup(h[c.groups[f]])&&++b:++b;l.groupCount=b;c=l=a;e=e.groups;h={};for(b=0;b<c.users.length;b++)h[c.users[b]]=1;for(b=0;b<c.groups.length;b++)if(c.groups[b]in e)for(var f=e[c.groups[b]],m=0;m<f.users.length;++m)h[f.users[m]]=1;e=_.keys(h).length;l.userCount=e;a.lastAccessed&&a.lastAccessed.timestampSec&&(a.lastAccessedString=formatTimestamp(1E3*a.lastAccessed.timestampSec));
a.lastModified&&a.lastModified.timestampSec&&(a.lastModifiedString=formatTimestamp(1E3*a.lastModified.timestampSec))}g=templates["secrets-admin-template"].render({secrets:k});$("#secrets-table").html(g);(g=$("#search-string").val())&&filterSecrets(g)},onBackgroundError)},onBackgroundError)})})();
