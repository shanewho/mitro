describe("passpack parse",function(){it("throws on bad input",function(){try{throw parseHtml(",,,,"),Error("expected exception");}catch(a){}});it("parses empty CSV",function(){var a=parseCSV("");expect(a).toEqual([])});it("parses data",function(){parsed=parseCSV('adsf,"as,,d,f","asdf,",,,,\nFake Secret 1,"FakeU,ser2",fakepassword2,reddit.com,,,\nFake Secret 2,"Fak,,e,User",FakePassword,google.com,,,\nFake Site w/ emoji,\ud83d\ude0d\ud83d\ude22\u21970\u20e3,\ud83c\udfe9\ud83c\udfe8\ud83c\udfe5,fake.com,,,');
expect(parsed.length).toBe(4);expect(parsed[1].username).toBe("FakeU,ser2");expect(parsed[1].password).toBe("fakepassword2");expect(parsed[1].loginurl).toBe("reddit.com");expect(parsed[1].title).toBe("Fake Secret 1")});it("parses CSV with string with embedded line-breaks",function(){passwords=[];parsed=parseCSV('Amazon AWS / ec2 / S3 Console Login,dev@songtrust.com,fdjksflkdsjflsda,console.aws.amazon.com,,"MFA NOT NEEDED\n\n\nAccount #             : fake\nAccess Key ID       : fake\nSecret Access Key : fake",dev@songtrust.com\nappfirst,dev@songtrust.com,rewqrewfoqopfew,https://wwws.appfirst.com/accounts/login/?next=/dashboard/,,,dev@songtrust.com');
expect(parsed.length).toBe(2)});it("parses files with DOS/Mac line endings",function(){passwords=[];parsed=parseCSV('Amazon AWS / ec2 / S3 Console Login,dev@songtrust.com,fdjksflkdsjflsda,console.aws.amazon.com,,"MFA NOT NEEDED\nSecret Access Key : fake",dev@songtrust.com\rappfirst,dev@songtrust.com,rewqrewfoqopfew,https://wwws.appfirst.com/accounts/login/?next=/dashboard/,,,dev@songtrust.com');expect(parsed.length).toBe(2)})});
