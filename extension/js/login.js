var initLoginForm;
(function(){var f=!1,d={};initLoginForm=function(){background.loadSettingsAsync(function(b){d=b;b=$("#mitro-login-form");b.removeClass("hide");var c=b.find('input[name="username"]'),a=userpass.hashToUsernamePassword();a.username&&a.token&&a.token_signature&&!a.password&&(a.password="**********");a.username||(a.username="");!a.username&&"username"in d&&(a.username=d.username);c.val(a.username);var e=null;a.username?(e=c=b.find('input[name="password"]'),a.password&&!f&&(c.val(a.password),b.submit(),
f=!0)):e=c;popupInitialFocus(e);void 0===d.rememberMe&&(d.rememberMe=!0);d.rememberMe||($(".remember-me").prop("checked",!1),$(".remember-me").trigger("change"))})};$(document).ready(function(){$("#mitro-login-form").submit(function(b){$("#login-error").hide();var c=function(a){$("#login-error").text(a);$("#login-error").show()},a=$(this);b=a.find('input[name="username"]').val();var e=a.find('input[name="password"]').val(),f=$(".remember-me").is(":checked"),g=userpass.hashToUsernamePassword();if(b)if(validateEmail(b))if(e){var h=
void 0;$("#tfa-code").is(":visible")&&(h=$("#tfa-code input[type=text]").val());$("#tfa-code").hide();background.mitroLogin(b,e,function(b){setTimeout(updateLoginState,100);a.find('input[name="password"]').val("")},function(a){a.userVisibleError?c(a.userVisibleError):c("Login error");updateLoginState()},function(a){c("Enter the 2-step verification code from your mobile application.");$("#tfa-code").show();updateLoginState();$("#tfa-code input[type=text]").focus()},g.token,g.token_signature,f,h);updateLoginState()}else c("Please enter your password");
else c("Invalid email address");else c("Please enter your email address");d.username=b;background.saveSettingsAsync(d);return!1});$(".remember-me").change(function(){$(this).is(":checked")?($(this).closest(".checkbox").addClass("checked"),$("#remind-alert").removeClass("hide"),d.rememberMe=!0):($(this).closest(".checkbox").removeClass("checked"),$("#remind-alert").addClass("hide"),d.rememberMe=!1)})});"undefined"!==typeof module&&module.exports&&(module.exports=initLoginForm)})();
