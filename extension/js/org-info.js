var mitro=mitro||{},kew=kew||require("../../../../api/js/cli/kew"),dictValues=dictValues||require("../../../common/utils").dictValues;mitro.OrganizationInfo=function(a){this.selectedOrgId=a.myOrgId;this.organizations=a.organizations};mitro.OrganizationInfo.prototype.getOrganization=function(a){return this.organizations&&a in this.organizations?this.organizations[a]:null};mitro.OrganizationInfo.prototype.getOrganizations=function(){return this.organizations?dictValues(this.organizations):[]};
mitro.OrganizationInfo.prototype.getSelectedOrganization=function(){return null===this.selectedOrgId?null:this.getOrganization(this.selectedOrgId)};mitro.OrganizationInfo.prototype.isOrgAdminFor=function(a){return(a=this.getOrganization(a))?a.isAdmin:!1};mitro._orgInfo=null;mitro._orgInfoPromises=[];mitro.onLoadOrganizationInfoSuccess=function(){for(var a=0;a<mitro._orgInfoPromises.length;++a)mitro._orgInfoPromises[a].resolve(mitro._orgInfo);mitro._orgInfoPromises=[]};
mitro.onLoadOrganizationInfoError=function(a){for(var b=0;b<mitro._orgInfoPromises.length;++b)mitro._orgInfoPromises[b].reject(a);mitro._orgInfoPromises=[]};
mitro.loadOrganizationInfo=function(a,b){if(null===mitro._orgInfo){var c=new kew.Promise;c.then(a).fail(b);mitro._orgInfoPromises.push(c);1===mitro._orgInfoPromises.length&&background.getOrganizationInfo(function(a){var b=null;try{mitro._orgInfo=new mitro.OrganizationInfo(a)}catch(c){b=c}if(b)mitro.onLoadOrganizationInfoError(b);else mitro.onLoadOrganizationInfoSuccess()},mitro.onLoadOrganizationInfoError)}else a(mitro._orgInfo)};
mitro.hackOrgInfoBackgroundForTest=function(a){background=a;mitro._orgInfo=null;mitro._orgInfoPromises=[]};"undefined"!==typeof module&&module.exports&&(module.exports=mitro);
