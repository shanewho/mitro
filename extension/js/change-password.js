$(document).ready(function(){$("#change-password-form").submit(function(a){var b=function(a){$("#password-error").text(a);$("#password-error").show()};a=null;0!==$(this).find('input[name="old-password"]').length&&(a=$(this).find('input[name="old-password"]').val());var c=$(this).find('input[name="new-password"]').val(),e=$(this).find('input[name="new-password2"]').val();if(a===c)b("New password must be different from old password");else if(c!==e)b("Passwords do not match");else if(passwords.validatePassword(c)){$("#password-error").hide();
var d=showSpinny($("#change-password-form-button")),e=userpass.hashToUsernamePassword();background.changePassword(a,c,e,function(a){helper.setLocation("secrets.html")},function(a){b(a);hideSpinny($("#change-password-form-button"),d)})}else b("Password is too weak");return!1});var d=userpass.hashToUsernamePassword();d.password&&($('input[name="old-password"]').val(d.password),$("#change-old-password-group").hide(),$("#password").focus())});
